PKGNAME=opencv
PKGSEC=libs
PKGDEP="numpy openjdk"
BUILDDEP="apache-ant beautifulsoup4 cudnn eigen-3 gdal gflags glog glu \
          gst-plugins-base-1-0 hdf5 jasper lapack libcl libdc1394 libglvnd \
          libgphoto2 libjpeg-turbo libpng libraw1394 libtheora libtiff \
          libtool libva libvorbis libwebp openblas openexr openjpeg protobuf \
          python-3 qt-5 swig tesseract tbb v4l-utils vtk vulkan-headers zlib"

PKGDES="Open Source Computer Vision Library"

PKGBREAK="frei0r-plugins<=1.4-3 waifu2x-converter-cpp<=1:5.2 \
          libkface<=17.04.2 digikam<=5.7.0 openimageio<=1.7.17"

CMAKE_AFTER="-DWITH_OPENCL=ON \
             -DWITH_OPENGL=ON \
             -DWITH_FFMPEG=ON \
             -DWITH_XINE=ON \
             -DWITH_FFMPEG=ON \
             -DWITH_GSTREAMER=ON \
             -DBUILD_WITH_DEBUG_INFO=OFF \
             -DENABLE_PRECOMPILED_HEADERS=OFF \
             -DBUILD_TESTS=OFF \
             -DBUILD_PERF_TESTS=OFF \
             -DBUILD_EXAMPLES=OFF \
             -DENABLE_LTO=OFF \
             -DINSTALL_C_EXAMPLES=OFF \
             -DINSTALL_PYTHON_EXAMPLES=OFF \
             -DOPENCV_EXTRA_MODULES_PATH=$SRCDIR/opencv_contrib-4.3.0/modules \
             -DOPENCV_GENERATE_PKGCONFIG=ON"
CMAKE_AFTER__AMD64=" \
             ${CMAKE_AFTER} \
             -DWITH_TBB=ON \
             -DCPU_BASELINE=SSE3"
CMAKE_AFTER__ARM64=" \
             ${CMAKE_AFTER} \
             -DENABLE_NEON=ON"
CMAKE_AFTER__ARMHF=" \
             ${CMAKE_AFTER} \
             -DENABLE_NEON=ON"

NOSTATIC=0
NOLTO__PPC64EL=1
