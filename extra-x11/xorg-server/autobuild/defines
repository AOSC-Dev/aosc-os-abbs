PKGNAME=xorg-server
PKGSEC=x11
PKGDEP="xkeyboard-config x11-app x11-lib libdrm pixman mesa libgcrypt libepoxy"
BUILDDEP="xcb-util-renderutil x11-proto xcb-util-image xcb-util-keysyms xcb-util-wm x11-app"
PKGDES="X.Org display server"

AUTOTOOLS_AFTER="--enable-ipv6 \
                 --enable-dri \
                 --enable-dri3 \
                 --enable-dmx \
                 --enable-xvfb \
                 --enable-xnest \
                 --enable-composite \
                 --enable-xcsecurity \
                 --enable-xorg \
                 --enable-xephyr \
                 --enable-glamor \
                 --enable-xwayland \
                 --enable-glx-tls \
                 --enable-kdrive \
                 --enable-kdrive-evdev \
                 --enable-kdrive-kbd \
                 --enable-kdrive-mouse \
                 --enable-config-udev \
                 --disable-systemd-logind \
                 --enable-install-setuid \
                 --enable-record \
                 --disable-xfbdev \
                 --disable-xfake \
                 --disable-static \
                 --libexecdir=/usr/bin \
                 --localstatedir=/var \
                 --with-xkb-path=/usr/share/X11/xkb \
                 --with-xkb-output=/var/lib/xkb \
                 --with-fontrootdir=/usr/share/fonts \
                 --with-sha1=libgcrypt"

# FIXME: causes segfault on armel.
if [[ "${CROSS:-$ARCH}" != "armel" ]]; then
    PKGDEP+=" libunwind"
    AUTOTOOLS_AFTER+=" --enable-libunwind"
else
    AUTOTOOLS_AFTER+=" --disable-libunwind"
fi

PKGBREAK="xf86-input-aiptek xf86-video-openchrome"
PKGCONFL="xf86-video-modesetting<=0.9.0-1"
PKGREP="xf86-video-modesetting<=0.9.0-1"

AB_FLAGS_RRO=0
AB_FLAGS_NOW=0

RECONF=no
