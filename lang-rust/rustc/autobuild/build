abinfo "Enabling Rust backtrace ..."
export RUST_BACKTRACE=1

if ab_match_arch mips64r6el; then
    #FIXME: avoid this flag in 1.75.0
    abinfo "Disabling rustc lints ..."
    export RUSTFLAGS="${RUSTFLAGS} --cap-lints allow"
fi

abinfo "Building Rustc ..."
python3 "$SRCDIR"/x.py dist

abinfo "Installing Rustc ..."
DESTDIR="$PKGDIR" \
    python3 "$SRCDIR"/x.py install

abinfo "Arch Linux: Deleting unnecesary files, e.g. components and manifest files only used for the uninstall script..."
(
    cd "$PKGDIR"/usr/lib/rustlib
    rm -v \
        components \
        install.log \
        manifest-* \
        rust-installer-version \
        uninstall.sh
)
