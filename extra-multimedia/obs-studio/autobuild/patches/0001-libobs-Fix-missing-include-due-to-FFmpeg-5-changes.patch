From e66542075d5d2cb51a14a0bdf3458ac10757de64 Mon Sep 17 00:00:00 2001
From: pkv <pkv@obsproject.com>
Date: Thu, 5 May 2022 14:56:21 +0200
Subject: [PATCH] libobs: Fix missing include due to FFmpeg 5 changes

Since [1], avcodec/version.h is not included anymore in codec.h and
therefore is not included any more  in avformat.h.
As a result, LIBAVCODEC_VERSION_INT is no longer defined. This commit
fixes the include.
Since obviously we can't ifdef the avcodec include by referring to an
avcodec version, we ifdef it with the avformat version which was bumped
at the same time [2].

[1] libavcodec: Split version.h
https://github.com/FFmpeg/FFmpeg/commit/f2da2e1458b76a1d6c068673430b46cf2850bc51
[2] doc: Add an entry to APIchanges about changes to version.h and
 version_major.h
https://github.com/FFmpeg/FFmpeg/commit/f3a0e2ee2b97e2d46b351c29853c056d126884e2

Signed-off-by: pkv <pkv@obsproject.com>
---
 libobs/media-io/media-remux.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/libobs/media-io/media-remux.c b/libobs/media-io/media-remux.c
index 2b39a74e2..20eaea238 100644
--- a/libobs/media-io/media-remux.c
+++ b/libobs/media-io/media-remux.c
@@ -22,7 +22,9 @@
 #include "../util/platform.h"
 
 #include <libavformat/avformat.h>
-
+#if LIBAVFORMAT_VERSION_INT >= AV_VERSION_INT(59, 20, 100)
+#include <libavcodec/version.h>
+#endif
 #include <sys/types.h>
 #include <sys/stat.h>
 
-- 
2.36.0

